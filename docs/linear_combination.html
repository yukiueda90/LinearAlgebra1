<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>線形代数1</title>
    <!-- style -->
    <link rel="stylesheet" href="./common/style.css">
    <!-- mathjax -->
    <script src="./common/import_mathjax.js"></script>
</head>

<body>
    <header>
        <!-- (no header) -->
    </header>

    <!-- contents -->
    <div class="wrapper">

    <!-- sidebar -->
    <div class="side" id="sidebar"></div>

    <div class="hamburger" onclick="toggleSidebar()">
        ☰
    </div>
    
    <!-- main -->
    <main role="main"><article id="section4"><h1>4: 線形結合</h1>
        <section id="section4-1"><h2>4.1: 線形結合, 線型独立の定義</h2>
            <p>
            単純な例として, $2\times 1$ 型の列ベクトルを考えてみる. 
            <a href="matrix.html#def_canonical_basis">標準基底</a> 
            \[
                \mathbf{e}_1 = \begin{pmatrix} 
                    1\cr 
                    0 
                \end{pmatrix}, \quad \mathbf{e}_2 = \begin{pmatrix} 
                    0\cr 
                    1
                \end{pmatrix}
            \]
            を用いると, 任意のベクトル $\begin{pmatrix}a\cr b\end{pmatrix}$ は,
            \[
                \begin{pmatrix} 
                    a\cr 
                    b 
                \end{pmatrix} = a\mathbf{e}_1 + b\mathbf{e}_2
            \]
            と表すことができる. 
            このように, あるベクトルを特定のベクトルたちの足し合わせ (<b>線型結合</b>) で表現することは, ベクトルを扱う際に重要な考え方となる.
            ここでは <b>線型独立</b>という概念を導入し, 行列に対する簡単な応用を紹介する.
            また, 線型独立なベクトルたちの線型結合を用いた計算例を紹介する.</p>

            <p>本来は, より抽象的に<b>ベクトル空間</b>を導入するところから始めるべきであろうが, ここでは簡単のため列ベクトルの線型結合および線型独立に限定して紹介することにする.</p>

            <div class="definition" data-name="線型結合" id="def_linear_combination">
                ベクトル $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ に対して,
                \[
                    c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + \dots + c_n\mathbf{v}_n
                \]
                という形のベクトルを $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ の<b>線型結合</b> (<b>linear combination</b>) という.
            </div><!-- / #definition -->

            <div class="example">
                <ul>
                    <li>$\mathbf{v}_1 = \begin{pmatrix} 
                        1\cr 
                        0
                    \end{pmatrix}, \ \mathbf{v}_2 = \begin{pmatrix} 
                        0\cr 
                        1 
                    \end{pmatrix}$ のとき, $\begin{pmatrix} 
                        a\cr 
                        b 
                    \end{pmatrix} = a\mathbf{v}_1 + b\mathbf{v}_2$ は $\mathbf{v}_1$, $\mathbf{v}_2$ の線型結合.
                    </li>
                    <li>$\mathbf{v}_1 = \begin{pmatrix} 
                        1\cr 
                        0
                    \end{pmatrix}, \ \mathbf{v}_2 = \begin{pmatrix} 
                        1\cr 
                        1 
                    \end{pmatrix}$ のとき, $\begin{pmatrix} 
                        a\cr 
                        b 
                    \end{pmatrix} = (a-b)\mathbf{v}_1 + b\mathbf{v}_2$ は $\mathbf{v}_1$, $\mathbf{v}_2$ の線型結合.
                    </li>
                </ul>
            </div><!-- / #example -->

            <p>上の例と同様に,
            \[
                \mathbf{v}_1 = \begin{pmatrix} 
                    1\cr 
                    0 
                \end{pmatrix},\quad \mathbf{v}_2 = \begin{pmatrix} 
                    0\cr 
                    1
                \end{pmatrix},\quad \mathbf{v}_3 = \begin{pmatrix} 
                    1\cr 
                    1 
                \end{pmatrix}
            \]
            というベクトルの組を考えてみる. このとき, 例えば
            \[
                \begin{pmatrix} 
                    a\cr 
                    b 
                \end{pmatrix} = a\mathbf{v}_1 + b\mathbf{v}_2 + 0\mathbf{v}_3 = (a-b)\mathbf{v}_1 + 0\mathbf{v}_2 + b\mathbf{v}_3
            \]
            のように, 同じベクトルを表現する方法が複数存在することになる. これは, $\mathbf{v}_3$ が
            \[
                \mathbf{v}_3 = \mathbf{v}_1 + \mathbf{v}_2
            \]
            という線型結合で表現されることが原因である. 
            この場合, 例えば $\mathbf{v}_3$ を除外したとしても, $\mathbf{v}$ はベクトル $\mathbf{v}_1$, $\mathbf{v}_2$ だけの線型結合で表現できる.
            このように, あるベクトルの組に対する線型結合を考える際には, ベクトルの組の中から他のベクトルの線型結合で表現できるものを除外しても構わない, ということになる.</p>
            
            <hr>

            <p>一方で, ベクトルの組 $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ を考えたとき, 任意の $k$ に対して $\mathbf{v}_k$ がそれ以外のベクトルの線型結合で表現することが<span class="wave">できない</span>ならば, そのようなベクトルの組 $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ は<b>線形独立</b>であるという.
            この定義は以下と同値である:</p>

            <div class="definition" data-name="線型独立" id="def_linear_independent">
                ベクトル $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ に対し,
                \[
                    c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + \dots + c_n\mathbf{v}_n = \mathbf{0} \iff c_1 = c_2 = \dots = c_n = 0
                \]
                が成立するとき, $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ は<b>線形独立</b> (<b>linearly independent</b>) であるという.
            </div><!-- / #definition -->

            <div class="remark">
                この定義より, ベクトル $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ が線型独立<span class="wave">でない</span>ならば, 
                \[
                    c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + \dots + c_n\mathbf{v}_n = \mathbf{0}
                \]
                を満たすような, $c_1 = c_2 = \dots = c_n = 0$ でない $c_1$, $c_2$, $\dots$, $c_n$ の選び方が存在する. 
            </div><!-- /remark -->

            <div class="example">
                <p>\[
                    \mathbf{v}_1 = \begin{pmatrix} 
                        1\cr 
                        0 
                    \end{pmatrix},\quad \mathbf{v}_2 = \begin{pmatrix} 
                        0\cr 
                        1
                    \end{pmatrix},\quad \mathbf{v}_3 = \begin{pmatrix} 
                        1\cr 
                        1 
                    \end{pmatrix}.
                \]</p>
                <ul>
                    <li>$\mathbf{v}_1$, $\mathbf{v}_2$ は線型独立.</li>
                    <li>$\mathbf{v}_1$, $\mathbf{v}_3$ は線型独立.</li>
                    <li>$\mathbf{v}_1$, $\mathbf{v}_2$, $\mathbf{v}_3$ は線型独立ではない. 
                        実際, 例えば $c_1=-1$, $c_2=-1$, $c_3=1$ に対して 
                        \[
                            c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + c_3\mathbf{v}_3 = \mathbf{0}.
                        \]
                    が成立する.</li>
                    <li>$\mathbf{v}_1$, $\mathbf{v}_2$, $\mathbf{0}$ は線型独立ではない.
                        実際, 任意の $c_4\neq0$ に対して
                        \[
                            0\mathbf{v}_1 + 0\mathbf{v}_2 + c_4\mathbf{v}_4 = \mathbf{0}.
                        \]
                        が成立する.
                    </li>
                </ul>
            </div><!-- / #example -->

            <div class="remark">
                線型独立であることを<b>一次独立</b>ということもある. また, 線型独立<span class="wave">でない</span>ことを<b>線形従属</b>もしくは<b>一次従属</b>であるということがある.
            </div><!-- /remark -->

        </section>

        <hr>

        <section id="section4-2"><h2>4.2: 線型独立と行列の正則性</h2>
            <p>ベクトル $\mathbf{v}_j$ を第 $j$ 列ベクトルとする正方行列を $V$ とおき, また $c_1$, $c_2$, $\dots$, $c_n$ たちを並べた列ベクトルを $\mathbf{c}$ とおく:
                \[
                    V = \begin{pmatrix} 
                        \mathbf{v}_1, \mathbf{v}_2, \dots, \mathbf{v}_n 
                    \end{pmatrix},\qquad \mathbf{c} = \begin{pmatrix} 
                        c_1\cr 
                        c_2\cr 
                        \vdots\cr 
                        c_n 
                    \end{pmatrix}
                \]
                いま, $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ が線形独立であるという定義は, 以下のように表現することもできる:
                \[
                    V\mathbf{c} = \mathbf{0} \iff \mathbf{c} = \mathbf{0}
                \]
                ここで<a href="elementary_operation.html#thm_homogeneous_linear_system">斉次 $1$ 次方程式系の議論</a>を思い出すと, 上が成立することは正方行列 $V$ が正則行列であることと同値である. 実際, $V^{-1}$ が存在するならば
                \[
                    V\mathbf{c} = \mathbf{0}\implies \mathbf{c} = V^{-1}V\mathbf{c} = V^{-1}\mathbf{0} = \mathbf{0}
                \]
                である. 一方で $V$ が正則でない場合は, ある条件を満たす全ての $\mathbf{c}$ が $V\mathbf{c}=\mathbf{0}$ の解となってしまうのだった. 
                そのような $\mathbf{c}$ には, $\mathbf{0}$ でないものも含まれるため, 正方行列 $V$ が正則でないならば $V$ の各列ベクトルは線形独立ではない.
            </p>
            <p>以上の事実を, 後から参照しやすいようにまとめておく:</p>

            <div class="theorem" data-name="線型独立性と正則性" id="thm_invertible_and_linear_independence">
                $n$ 次正方行列 $A = \begin{pmatrix}\mathbf{a}_1&\mathbf{a}_2&\dots&\mathbf{a}_n\end{pmatrix}$ に対して,
                \[
                    A\text{ が正則} \iff \mathbf{a}_1,\ \mathbf{a}_2,\ \dots, \ \mathbf{a}_n\in\mathbb{R}^{n\times 1}\text{ が線型独立}
                \]
                が成立する, ここで各 $\mathbf{a}_j$ は $A$ の第 $j$ 列ベクトルである.
            </div><!-- / #theorem -->

            <div class="remark">
                <p>$\det A^{\operatorname{T}} = \det A$ であることから, 以下も成立する:</p>
                <p>$n$ 次正方行列 $A = \begin{pmatrix}\mathbf{a}_1\cr \mathbf{a}_2\cr\vdots\cr\mathbf{a}_n\end{pmatrix}$ に対して,
                    \[
                        A\text{ が正則} \iff \mathbf{a}_1,\ \mathbf{a}_2,\ \dots, \ \mathbf{a}_n\in\mathbb{R}^{1\times n}\text{ が線型独立}
                    \]
                    が成立する, ここで各 $\mathbf{a}_i$ は $A$ の第 $i$ 行ベクトルである.</p> 
            </div><!-- / #remark -->

            <div class="example">
                \[
                    A = \begin{pmatrix} 
                        1&2\cr 
                        2&4 
                    \end{pmatrix},\qquad B = \begin{pmatrix} 
                        1&2&0\cr 
                        0&4&3\cr
                        -2&0&3\cr
                    \end{pmatrix} 
                \]
                <ul>
                    <li>$A$ の第 $i$ 行ベクトルを $\mathbf{a}_i$ とおく: 
                        \[
                            \mathbf{a}_1 = (1,2),\quad \mathbf{a}_2 = (2,4).
                        \] 
                        $2\mathbf{a}_1 - \mathbf{a}_2 = \mathbf{0}$ なのでこれらは線型独立でない. 
                        従って, $A$ は正則行列ではない (実際, $\det A = 0$ を確かめることができる).</li>
                    <li>$B$ の第 $i$ 行べクトルを $\mathbf{b}_i$ とおく: 
                        \[
                            \mathbf{b}_1 = (1,2,0),
                        \]
                        \[
                            \mathbf{b}_2 = (0,4,3), 
                        \]
                        \[
                            \mathbf{b}_3 = (-2,0,3).
                        \]
                        $-2\mathbf{b}_1 + \mathbf{b}_2 - \mathbf{b}_3 = \mathbf{0}$ なのでこれらは線型独立でない. 
                        従って, $B$ は正則行列ではない (実際, $\det B=0$ を確かめることができる).</li>
                </ul>
            </div><!-- / #example -->

            <div class="example">
                <p>\[
                    \mathbf{v}_1 = \begin{pmatrix} 
                        1\cr 
                        1\cr 
                        0 
                    \end{pmatrix}, \quad \mathbf{v}_2 = \begin{pmatrix} 
                        0\cr 
                        1\cr 
                        1 
                    \end{pmatrix},\quad \mathbf{v}_3 = \begin{pmatrix} 
                        1\cr 
                        a\cr 
                        1 
                    \end{pmatrix}.  
                \]
                これらが線型独立となる条件を求めてみる. 第 $j$ 列ベクトルが $\mathbf{v}_j$ である行列 
                \[
                    V = \begin{pmatrix} 
                        \mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3 
                    \end{pmatrix} = \begin{pmatrix} 
                        1&0&1\cr 
                        1&1&a\cr 
                        0&1&1 
                    \end{pmatrix}
                \]
                は正方行列となり, また $\det V = 2-a$ なので, $a\neq2$ であれば $V$ は正則である. 
                従って, $a\neq 2$ ならば $\mathbf{v}_1$, $\mathbf{v}_2$, $\mathbf{v}_3$ は線型独立である.
            </p>
            </div>

            <hr>

            ついでにこれまでに述べた行列の性質のいくつかを振り返り, 線型独立性との関連を考察してみる:

            <div class="theorem">
				<p>正方行列 $A$ の 異なる $2$ つの列 (もしくは行) が一致するならば $\det A=0$.</p>	
			</div><!-- / #theorem -->

            <p>このことは, 線型独立性を用いて以下のように説明することができる:</p> 
            <p>異なる $2$ つの列 (もしくは行) が等しいならば, 行列 $A$ の各列ベクトル (もしくは各行ベクトル) が線形独立ではないため, $A$ は正則ではない. 
            従って $\det A =0$ である.</p>

            <div class="theorem" data-name="斉次連立 $1$ 次方程式の解" id="thm_homogeneous_linear_system_proof">
                <p>$n$ 次正方行列 $A$ についての斉次連立 $1$ 次方程式 $A\mathbf{x}=\mathbf{0}$ について, 以下が成立する: </p>
                \[
                    A \text{が正則} \iff \text{非自明な解は存在しない.}
                \]
            </div><!-- /theorem -->
            <div class="proof">
                <ul>
                    <li>$(\implies)$ 行列 $A$ が正則ならば $A^{-1}$ が存在するので,
                        \[
                            \mathbf{x} = A^{-1}A\mathbf{x} = A^{-1}\mathbf{0} = \mathbf{0},
                        \]
                        つまり $\mathbf{x}=\mathbf{0}$ 以外の解は存在しない. 
                    </li>
                    <li>$(\impliedby)$ 対偶を示す:&emsp; $A\in\mathbb{R}^{n\times n}$ が正則でないとき, $A\mathbf{x}=\mathbf{0}$ に $\mathbf{x}=\mathbf{0}$ 以外の解が存在することを示せば良い.<br>
                    <p>行列 $A$ の第 $i$ 列ベクトルを $\mathbf{a}_i$ とおき, $\mathbf{x}$ の第 $j$ 行を $x_j$ とおく.
                        このとき, 
                        \[
                            A\mathbf{x} = x_1\mathbf{a}_1 + x_2\mathbf{a}_2 + \dots + x_n\mathbf{a}_n
                        \]
                        である. いま, $A$ は正則でないので (<a href="#thm_invertible_and_linear_independence">線型独立性と正則性</a>の関係より) $n$ 個のベクトル $\mathbf{a}_1$, $\mathbf{a}_2$, $\dots$, $\mathbf{a}_n$ は線型独立ではない. 
                        従って, (<a href="#def_linear_independent">線型独立の定義</a>より)
                        \[
                            A\mathbf{x} = x_1\mathbf{a}_1 + x_2\mathbf{a}_2 + \dots + x_n\mathbf{a}_n = \mathbf{0}
                        \]
                        を満たすような, $x_1 = x_2 = \dots = x_n =0$ でない $\mathbf{x}$ が存在する. 
                    </p></li>
                </ul>
                    
            </div><!-- / #proof -->


            <div class="theorem">
                <p>$A$ を $n$ 次正方行列とする. このとき, 以下が成立する:
                \[
                    \operatorname{rank}A = n \iff A \text{ は正則}.
                \]</p>
            </div><!-- / #theorem -->
            
            <p>このことは, 線型独立性を用いて以下のように説明することができる:</p> 
            <p>$\operatorname{rank}A = n$, すなわち正方行列 $A$ がフルランクであることは, 行基本変形のみ (もしくは列基本変形のみ) で行列 $A$ を単位行列にすることができることを意味しているのだった. 
                行基本変形は
                <ul>
                    <li>第 $i$ 行と第 $j$ 行を入れ替える.</li>
                    <li>第 $i$ 行に $0$ でない数を掛ける.</li>
                    <li>第 $i$ 行に第 $j$ 行のスカラー倍を加える.</li>
                </ul>
                という操作の組み合わせであったが, これは行列 $A$ の各第 $i$ 行ベクトル $\mathbf{a}_i$ を 
                \[
                    c_1\mathbf{a}_1 + c_2\mathbf{a}_2 + \dots + c_n\mathbf{a}_n
                \]
                に取り替える操作とみなすことができる, ただし 
                \[
                    c_1 = c_2 = \dots = c_n = 0
                \] 
                とすることは, 行基本変形では認められない.
                このことから, 
                \[
                    \begin{array}{l}
                        &\text{$A$ が正則} \cr
                        \iff &\mathbf{a}_1,\ \mathbf{a}_2, \ \dots, \ \mathbf{a}_n\text{ が線型独立}\cr 
                        \iff & \left(c_1\mathbf{a}_1 + c_2\mathbf{a}_2 + \dots + c_n\mathbf{a}_n = \mathbf{0} \iff c_1 = c_2 = \dots c_n = 0\right)\cr
                        \iff & \text{行列 $A$ に対する行基本変形では, どの行も $\mathbf{0}$ にできない} \cr 
                        \iff &\operatorname{rank}A = n
                    \end{array}
                \] 
                が得られる.
            </p>

            <p>
                逆に, $m\times n$ 型行列 $A$ の階数が $m$ よりも小さくなるなら, $A$ の行ベクトルのいくつかは行基本変形で $\mathbf{0}$ となってしまう, すなわち他の行の線型結合で表すことができる, ということを意味している.
                $m\times n$ 型行列 $A$ の階数が $n$ より小さい場合は, 列ベクトルに対して同様のことが言える.
            </p>

            <div class="example">
                \[
                    A = \begin{pmatrix} 
                        1&2\cr 
                        2&4 
                    \end{pmatrix},\qquad B = \begin{pmatrix} 
                        1&2&0\cr 
                        0&4&3\cr
                        -2&0&3\cr
                    \end{pmatrix} 
                \]
                <ul>
                    <li>$A$ の第 $i$ 行ベクトルを $\mathbf{a}_i$ とおく:
                        \[
                            \mathbf{a}_1 = (1,2),\quad \mathbf{a}_2 = (2,4).
                        \] 
                        $2\mathbf{a}_1 - \mathbf{a}_2 = \mathbf{0}$ なのでこれらは線型独立でない. 
                        つまり, 第 $2$ 行に第 $1$ 行の $-2$ 倍を加える, という行基本変形により
                        \[
                            R_{2,1,-2}A = \begin{pmatrix} 
                                1&2\cr 
                                0&0 
                            \end{pmatrix}
                        \]
                        となり, $\mathbf{0}$ となる行が現れる. 従って, $\operatorname{rank}A = 1$ である.</li>
                    <li>$B$ の第 $i$ 行べクトルを $\mathbf{b}_i$ とおく:
                        \[
                            \mathbf{b}_1 = (1,2,0),
                        \]
                        \[
                            \mathbf{b}_2 = (0,4,3), 
                        \]
                        \[
                            \mathbf{b}_3 = (-2,0,3).
                        \]
                        $-2\mathbf{b}_1 + \mathbf{b}_2 - \mathbf{b}_3 = \mathbf{0}$ なのでこれらは線型独立でない. 
                        つまり, 第 $3$ 行に第 $1$ 行の $2$ 倍を加え, さらに第 $3$ 行に第 $2$ 行の $-1$ 倍を加える, という行基本変形を考えると
                        \[
                            R_{3,2,-1}R_{3,1,2}B = \begin{pmatrix} 
                                1&2&0\cr 
                                0&4&3\cr 
                                0&0&0
                            \end{pmatrix}
                        \]
                        となり, $\mathbf{0}$ となる行が現れる. 従って, $\operatorname{rank}B \lt 3$ である (なお, $\mathbf{b}_1$ と $\mathbf{b}_2$ は線型独立なので, これ以上 $\mathbf{0}$ となる行を増やすことはできない, これは $\operatorname{rank}B = 2$ を意味する).</li>
                </ul>
            </div><!-- / #example -->
        </section>

        <hr>

        <section id="section4-3"><h2>4.3: 線型結合によるベクトルの表現</h2>
            <p>あるベクトル $\mathbf{v}$ を, 線型独立なベクトル $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ の線型結合で表したい:
                \[
                    \mathbf{v} = c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + \dots + c_n\mathbf{v}_n.
                \]
                先ほどと同じ記号を用いると, 右辺は$V\mathbf{c}$ となるため, 上の式は
                \[
                    V\mathbf{c} = \mathbf{v}
                \]
                という連立 $1$ 次方程式とみなすことができ, これを解くことで等号を成立させる $c_1$, $c_2$, $\dots$, $c_n$ を求めることができる.</p>
            <p>特に, $\mathbf{v}_i\in\mathbb{R}^{n\times 1}$ ならば, $V$ は $n$ 次正方行列となり, 先ほどの結果より正則行列となる, 従って, $V^{-1}$ が存在して $\mathbf{c} = V^{-1}\mathbf{v}$ が一意に定まる. 
                このことは, 以下のように言い換えることもできる:</p>

            <div class="theorem">
                $n$ 個の $n\times 1$ 型列ベクトル 
                \[
                    \mathbf{v}_1,\ \mathbf{v}_2,\ \dots,\ \mathbf{v}_n\in\mathbb{R}^{n\times 1}
                \] 
                が線型独立ならば, 任意のベクトル $\mathbf{v}\in\mathbb{R}^{n\times 1}$ は $\mathbf{v}_1$, $\mathbf{v}_2$, $\dots$, $\mathbf{v}_n$ の線型結合で表すことができる.
            </div><!-- / #theorem-->

            <div class="example">
                <p>\[
                    \mathbf{v} = \begin{pmatrix} 
                        a\cr 
                        b\cr 
                        c
                    \end{pmatrix},\quad \mathbf{v}_1 = \begin{pmatrix} 
                        1\cr 
                        1\cr 
                        0 
                    \end{pmatrix}, \quad \mathbf{v}_2 = \begin{pmatrix} 
                        0\cr 
                        1\cr 
                        1 
                    \end{pmatrix}, \quad \mathbf{v}_3 = \begin{pmatrix} 
                        1\cr 
                        1\cr 
                        1 
                    \end{pmatrix}.
                \]
                このとき,
                \[
                    \mathbf{v} = c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + c_3\mathbf{v}_3
                \]
                を満たす $c_1$, $c_2$, $c_3$ を求める.</p>
                <p>まず, $V = \begin{pmatrix} 
                        \mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3 
                    \end{pmatrix} = \begin{pmatrix} 
                        1&0&1\cr 
                        1&1&1\cr
                        0&1&1 
                    \end{pmatrix}$ とおくと, 連立 $1$ 次方程式 $V\mathbf{c} = \mathbf{v}$ を解けば良いことがわかる (なお, $\det V = 1\neq0$ なので $V$ は正則行列である).</p>
                <p>これを<a href="elementary_operation.html#thm_Gauss_elimination">掃き出し法</a>により計算してみよう: 拡大行列に対する行基本変形により,
                    \[
                        \begin{array}{rl} 
                            \left(\begin{array}{ccc:c}
                                1&0&1&a\cr 
                                1&1&1&b\cr 
                                0&1&1&c    
                            \end{array}\right) & \longrightarrow \left(\begin{array}{ccc:c}
                                1&0&1&a\cr 
                                0&1&0&b-a\cr 
                                0&1&1&c    
                            \end{array}\right) \cr
                            & \longrightarrow \left(\begin{array}{ccc:c}
                                1&0&1&a\cr 
                                0&1&0&b-a\cr 
                                0&0&1&a-b+c    
                            \end{array}\right) \cr
                            & \longrightarrow \left(\begin{array}{ccc:c}
                                1&0&0&b-c\cr 
                                0&1&0&b-a\cr 
                                0&0&1&a-b+c    
                            \end{array}\right)
                        \end{array}
                    \]
                    と変形すると, 左側を単位行列にすることができるため, 右側が
                    \[
                        \begin{pmatrix} 
                            c_1\cr 
                            c_2\cr 
                            c_3 
                        \end{pmatrix} = \mathbf{c} = V^{-1}\mathbf{v} = \begin{pmatrix} 
                            b-c\cr 
                            b-a\cr
                            a-b+c 
                        \end{pmatrix}
                    \]
                    を意味している.
                </p>
            </div><!-- / #example -->

            <hr>

            <p>一方で, 行列 $V$ が正則行列でないならば, 連立 $1$ 次方程式 $V\mathbf{c} = \mathbf{v}$ の解は存在しないか, もしくはある条件を満たす $\mathbf{c}$ 全てが解となるのだった. 
                このことは, $\mathbf{v}$ が $\mathbf{v}_1,\ \mathbf{v}_2,\ \dots$ の線型結合で表せないか, もしくは複数の表現が存在することに対応する:</p>

            <div class="example">
                <p>\[
                    \mathbf{v} = \begin{pmatrix} 
                        a\cr 
                        b\cr 
                        c
                    \end{pmatrix},\quad \mathbf{v}_1 = \begin{pmatrix} 
                        1\cr 
                        1\cr 
                        0 
                    \end{pmatrix}, \quad \mathbf{v}_2 = \begin{pmatrix} 
                        0\cr 
                        1\cr 
                        1 
                    \end{pmatrix}, \quad \mathbf{v}_3 = \begin{pmatrix} 
                        1\cr 
                        2\cr 
                        1 
                    \end{pmatrix}.
                \]
                このとき,
                \[
                    \mathbf{v} = c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + c_3\mathbf{v}_3
                \]
                を満たす $c_1$, $c_2$, $c_3$ を求める.</p>
                <p>まず, $V = \begin{pmatrix} 
                        \mathbf{v}_1, \mathbf{v}_2, \mathbf{v}_3 
                    \end{pmatrix} = \begin{pmatrix} 
                        1&0&1\cr 
                        1&1&2\cr
                        0&1&1 
                    \end{pmatrix}$ とおくと, 連立 $1$ 次方程式 $V\mathbf{c} = \mathbf{v}$ を解けば良いことがわかる (ただし, $\det V = 0$ なので $V$ は正則行列ではない).</p>
                <p>これを掃き出し法により計算してみよう: 拡大行列に対する行基本変形により,
                    \[
                        \begin{array}{rl} 
                            \left(\begin{array}{ccc:c}
                                1&0&1&a\cr 
                                1&1&2&b\cr 
                                0&1&1&c    
                            \end{array}\right) & \longrightarrow \left(\begin{array}{ccc:c}
                                1&0&1&a\cr 
                                0&1&1&b-a\cr 
                                0&1&1&c    
                            \end{array}\right) \cr
                            & \longrightarrow \left(\begin{array}{ccc:c}
                                1&0&1&a\cr 
                                0&1&1&b-a\cr 
                                0&0&0&a-b+c    
                            \end{array}\right)
                        \end{array}
                    \]
                    と変形すると, 拡大行列の左側を<a href="elementary_operation.html#def_row_echelon_form">行簡約階段形</a>にすることができる.
                    ここで, 一番下の行は
                    \[
                        0\cdot c_1+0\cdot c_2+0\cdot c_3 = a-b+c
                    \]
                    を意味しているため, $a-b+c\neq0$ のときはこれを満たす $\mathbf{c}$ は存在しない. 
                    一方で, もしも $a-b+c=0$ ならば, 
                    \[
                        \left\lbrace\begin{array}{rl}
                            c_1+c_3 &= a\cr
                            c_2+c_3 &= b-a 
                        \end{array}\right.
                    \]
                    を満たす $c_1$, $c_2$, $c_3$ は全て連立 $1$ 次方程式の解であり, 従って $\mathbf{v} = c_1\mathbf{v}_1+c_2\mathbf{v}_2 + c_3\mathbf{v}_3$ を満たす. 
                    実際, 
                    \[  
                        \begin{array}{rl}
                            c_1\mathbf{v}_1 + c_2\mathbf{v}_2 + c_3\mathbf{v}_3 
                            &= (a-c_3)\mathbf{v}_1 + (b-a-c_3)\mathbf{v}_2 + c_3\mathbf{v}_3 \cr 
                            &= \begin{pmatrix} 
                                a-c_3+c_3\cr
                                a-c_3+b-a-c_3+2c_3\cr 
                                b-a-c_3+c_3 
                            \end{pmatrix} \cr 
                            &= \begin{pmatrix} 
                                a\cr 
                                b\cr 
                                c 
                            \end{pmatrix} \qquad (\because a-b+c=0)\cr 
                            &=\mathbf{v}
                        \end{array} 
                    \]
                    などと計算することで $\mathbf{v} = c_1\mathbf{v}_1+c_2\mathbf{v}_2 + c_3\mathbf{v}_3$ となることが確かめられる.
                </p>
            </div><!-- / #example -->

            <hr>

            <p>上に挙げた例では, 
                \[
                    \begin{pmatrix}
                        1 & 0 & 1 \cr 
                        1 & 1 & 2 \cr 
                        0 & 1 & 1 
                    \end{pmatrix}\begin{pmatrix} 
                        c_1 \cr 
                        c_2 \cr 
                        c_3 
                    \end{pmatrix} = \begin{pmatrix} 
                        a \cr 
                        b \cr 
                        c
                    \end{pmatrix} 
                \]
                という連立 $1$ 次方程式を考えた際に, もしも $a-b+c=0$ ならば, 
                \[
                    \left\lbrace\begin{array}{rl}
                        c_1+c_3 &= a\cr
                        c_2+c_3 &= b-a 
                        \end{array}\right.
                \]
                を満たす $c_1$, $c_2$, $c_3$ は全て連立 $1$ 次方程式の解であること, 書き方を変えると 
                \[
                    \mathbf{c} = \begin{pmatrix} 
                        a \cr 
                        b-a \cr 
                        0 
                    \end{pmatrix} + c_3\begin{pmatrix} 
                        -1 \cr 
                        -1 \cr 
                        1 
                    \end{pmatrix} \quad (c_3\in\mathbb{R}\mbox{ は任意})
                \]
                と表されるすべてのベクトル $\mathbf{c}$ が, $V\mathbf{c} = \mathbf{v}$ の解となることを意味している.
                このように, 連立 $1$ 次方程式の解が無数に存在する場合 (ある条件を満たすベクトル全てが解となる場合) には, 線型結合を用いて解を表すことができる.
                このことを説明するために, 連立 $1$ 次方程式の解法をもう一度考えてみよう.</p>

            <div class="example">
                <p>連立 $1$ 次方程式 
                    \[
                        \begin{pmatrix} 
                            1 & 0 & 0 & 1 \cr 
                            2 & 0 & 3 & 5 
                        \end{pmatrix}\begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = \begin{pmatrix} 
                            0 \cr 
                            0 \cr 
                        \end{pmatrix} 
                    \]
                    を考える. まず, 左辺の行列は正則ではない (正方行列ですらない) ため, 拡大行列 
                    \[
                        \left(\begin{array}{cccc:c} 
                            1 & 0 & 0 & 1 & 0 \cr 
                            2 & 0 & 3 & 5 & 0 
                        \end{array}\right)
                    \] に対する掃き出し法 (ガウスの消去法) で左側を単位行列にすることはできない. 
                    ただし, <a href="elementary_operation.html#def_row_echelon_form">行簡約階段形</a>にすることはできる:
                    \[
                        \left(\begin{array}{cccc:c}
                            1 & 0 & 0 & 1 & 0 \cr 
                            0 & 0 & 1 & 1 & 0 
                        \end{array}\right)
                    \]
                    この拡大行列は, 
                    \[
                        \left\{\begin{array}{rl} 
                            x_1 + x_4 &= 0, \cr 
                            x_3 + x_4 &= 0 
                        \end{array}\right.
                    \]
                    を満たす全ての $x_1$, $x_2$, $x_3$, $x_4$ が解となることを意味している.</p>
                <p>ここで, 解を
                    \[
                        \begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = s\mathbf{v}_1 + t\mathbf{v}_2 \quad(s,t\in\mathbb{R}\mbox{ は任意})
                    \]
                    という<a href="#def_linear_combination">線型結合</a>で表現してみよう. 
                    例えば, 上の行簡約階段形において主成分に対応する成分 $x_1$, $x_3$ <span class="wave">以外</span> (つまり $x_2$ と $x_4$) を $s$, $t\in\mathbb{R}$ とおいてみる:
                    \[
                        x_2 = s,\qquad x_4 = t.
                    \]
                    このとき, $s$, $t$ を右辺に移行することで (実際には $s$ は現れないが), 
                    \[
                        \left\{\begin{array}{rl} 
                            x_1 &= -t, \cr 
                            x_3 &= -t 
                        \end{array}\right.
                    \]
                    という式が得られる. これと $x_2=s$, $x_4 = t$ とを合わせると
                    \[
                        \begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = s\begin{pmatrix} 
                            0 \cr 
                            1 \cr 
                            0 \cr 
                            0 
                        \end{pmatrix} + t\begin{pmatrix} 
                            -1 \cr 
                            0 \cr 
                            -1 \cr 
                            1 
                        \end{pmatrix} \quad (s,t\in\mathbb{R}\mbox{ は任意})
                    \]
                    という表示を得ることができる. つまり, $2$ つのベクトル
                    \[
                        \begin{pmatrix} 
                            0 \cr 
                            1 \cr 
                            0 \cr 
                            0 
                        \end{pmatrix},\quad \begin{pmatrix} 
                            -1 \cr 
                            0 \cr 
                            -1 \cr 
                            1 
                        \end{pmatrix}
                    \]
                    の線型結合で表される全てのベクトルが, この問題の解となることがわかる.
                </p>
            </div><!-- /example -->

            <div class="remark">
                上のように, 連立 $1$ 次方程式の解を線型結合の形で表す際には, 拡大行列に対する行基本変形により得られる行簡約階段形について, <span class="wave">主成分に対応するもの以外</span>を変数だと思って式変形することを推奨する. 
                ただし, そうしなければならないというわけではない. 
            </div><!-- /remark -->

            <div class="example">
                <p>連立 $1$ 次方程式 
                    \[
                        \begin{pmatrix} 
                            1 & 1 & 3 & 3 \cr 
                            1 & 2 & 5 & 4 
                        \end{pmatrix}\begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = \begin{pmatrix} 
                            0 \cr 
                            0 \cr 
                        \end{pmatrix} 
                    \]
                    を考える. 拡大行列 
                    \[
                        \left(\begin{array}{cccc:c} 
                            1 & 1 & 3 & 3 & 0 \cr 
                            1 & 2 & 5 & 4 & 0 
                        \end{array}\right)
                    \] 
                    を行基本変形で行簡約階段形にすると,
                    \[
                        \left(\begin{array}{cccc:c}
                            1 & 0 & 1 & 2 & 0 \cr 
                            0 & 1 & 2 & 1 & 0 
                        \end{array}\right)
                    \]
                    が得られる. これは, 
                    \[
                        \left\{\begin{array}{rl}
                            x_1 + x_3 + 2x_4 &= 0, \cr 
                            x_2 + 2x_3 + x_4 &= 0
                        \end{array}\right.
                    \]
                    を満たす全ての $x_1$, $x_2$, $x_3$, $x_4$ がこの問題の解となることを意味している. 
                </p>
                <p>この問題の解を線型結合の形で表す際は, 上の注意で述べたように, 行簡約階段形の主成分に対応するもの<span class="wave">以外</span> (この例では $x_3$, $x_4$) を $s$, $t$ などとおくことを推奨する: 
                    \[
                        \left\{\begin{array}{rl}
                            x_1 &= -s - 2t, \cr 
                            x_2 &= -2s - t, \cr 
                            x_3 &= s, \cr 
                            x_4 &= t.
                        \end{array}\right.
                    \]
                    つまり解は 
                    \[
                        \begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = s\begin{pmatrix} 
                            -1 \cr 
                            -2 \cr 
                            1 \cr 
                            0 
                        \end{pmatrix} + t\begin{pmatrix} 
                            -2 \cr 
                            -1 \cr 
                            0 \cr 
                            1 
                        \end{pmatrix} \quad (s,t\in\mathbb{R} \mbox{ は任意})
                    \]
                    と表される. </p>
                <p>一方で, もしも $x_1=s$, $x_2=t$ とおくとどうなるかを考えてみる. 
                    この場合は, 
                    \[
                        \left\{\begin{array}{rl}
                            x_3 + 2x_4 &= -s, \cr 
                            2x_3 + x_4 &= -t
                        \end{array}\right.
                    \]
                    となるため, この連立 $1$ 次方程式を解くことで 
                    \[
                        \left\{\begin{array}{rl}
                            x_1 &= s, \cr 
                            x_2 &= t, \cr 
                            x_3 &= \dfrac{s-2t}{3}, \cr
                            x_4 &= \dfrac{-2s+t}{3}
                        \end{array}\right.
                    \]
                    が得られる. ここで, $s/3$, $t/3$ を改めて $\widetilde{s}$, $\widetilde{t}$ とそれぞれ書くことにすると
                    \[
                        \begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = \widetilde{s}\begin{pmatrix} 
                            3 \cr 
                            0 \cr 
                            1 \cr 
                            -2 
                        \end{pmatrix} + \widetilde{t}\begin{pmatrix} 
                            0 \cr 
                            3 \cr 
                            -2 \cr 
                            1 
                        \end{pmatrix} \quad (\widetilde{s},\widetilde{t}\in\mathbb{R} \mbox{ は任意})
                    \]
                    と, 先ほどとは異なる表示が得られたが, これも解の表示として正しい. 
                    これは, 
                    \[
                        \begin{pmatrix} 
                            -1 \cr 
                            -2 \cr 
                            1 \cr 
                            0 
                        \end{pmatrix},\quad \begin{pmatrix} 
                            -2 \cr 
                            -1 \cr 
                            0 \cr 
                            1 
                        \end{pmatrix}
                    \]
                    という $2$ つのベクトルの線型結合で表すことができるベクトル全体と, 
                    \[
                        \begin{pmatrix} 
                            3 \cr 
                            0 \cr 
                            1 \cr 
                            -2 
                        \end{pmatrix},\quad \begin{pmatrix} 
                            0 \cr 
                            3 \cr 
                            -2 \cr 
                            1 
                        \end{pmatrix}
                    \] という $2$ つのベクトルの線型結合で表すことができるベクトル全体が一致するために, 複数の表現が存在するのである.
                </p>
            </div><!-- /example -->

        </section>

        <hr>

        <section><h2>練習問題</h2>

            <div class="problem">
                <p>実数 $a$, $b$, $c$, $d$ に対して, 
                    \[
                        \mathbf{v}_1 = \begin{pmatrix} 
                            a \cr 
                            2 
                        \end{pmatrix},\quad \mathbf{v}_2 = \begin{pmatrix} 
                            1 \cr b 
                        \end{pmatrix},\quad \mathbf{v} = \begin{pmatrix} 
                            c \cr 
                            d 
                        \end{pmatrix}
                    \]
                    とする.
                </p>
                <ul>
                    <li>$2$ つのベクトル $\mathbf{v}_1$, $\mathbf{v}_2$ を線型独立にするような $a$, $b$ の満たす条件を求めよ.</li>
                    <li>上の条件が満たされるとき, ベクトル $\mathbf{v}$ を $2$ つのベクトル $\mathbf{v}_1$, $\mathbf{v}_2$ の線型結合で表現せよ.</li>
                </ul>
            </div>

            <div class="problem">
                <p>次の連立 $1$ 次方程式を解け: 
                    \[
                        \begin{pmatrix}
                            1 & -4 & 0 & -7 \cr 
                            1 & -3 & 1 & -5
                        \end{pmatrix}\begin{pmatrix} 
                            x_1 \cr 
                            x_2 \cr 
                            x_3 \cr 
                            x_4 
                        \end{pmatrix} = \begin{pmatrix} 
                            0 \cr 
                            0 
                        \end{pmatrix}.
                    \]
                </p>
            </div><!-- /problem -->

            <a href="exercises.html#section4_answer">解答例</a>
        </section>
    
    </article></main>
    </div>
</body>

<!-- javascript -->
<script src="./common/create_statement_block.js"></script>
<script src="./common/function_toggleSidebar.js"></script>
<script src="./common/import_sidebar.js"></script>

</html>